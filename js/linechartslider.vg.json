
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "columns": 1,
  "concat": 
  [
    {
      "width": 900,
      "height": 30,
      "title": "date range selector",
      "data": {"url": "https://raw.githubusercontent.com/xzmonash/data/master/2021/cases_malaysia.csv"},
      "mark": "line",
      "params": [{
          "name": "brush",
          "select": {"type": "interval", "encodings": ["x"]}
      }],
      "encoding": {
          "x": {
              "timeUnit": "yearmonthdate",
              "field": "date",
              "scale": {"domain": [{"year": 2021, "month": "jan", "date": 1}, {"year": 2021, "month": "oct", "date": 13}]},
              "axis": {"title": ""}
          },
          "color": {"value": "white"}
      }
  
    },
    {
    "width": 900,
    "height": 250,
    "data": {"url": "https://raw.githubusercontent.com/xzmonash/data/master/2021/cases_malaysia.csv"},
    "title": "Daily New Covid-19 Cases in Malaysia",
    "encoding": {
        "x": {
            "timeUnit": "yearmonthdate",
            "field": "date",
            "scale": {"domain": {"param": "brush"}},
           "axis": {"title": ""}
        },
        "y": {"type": "quantitative", "axis": {"title": ""}},
        "tooltip": [
  
        ]
    },
    "layer":[
        
        {   
            "data": {"url": "https://raw.githubusercontent.com/xzmonash/data/master/2021/malaysia.csv"},
            "mark": {"type": "area", "color": "blue", "opacity": 0.7},
            "encoding": {
                "y": {"field": "cases_new"},
                "tooltip":[
                  {
                    "field": "cases_new",
                    "type": "quantitative",
                    "title": "New Cases"
                  },
                  {"timeUnit":"yearmonthdate","field":"date", "title": "Date"}

                ]
            }
        },
        {   "data": {"url": "https://raw.githubusercontent.com/xzmonash/data/master/2021/7ma_malaysia2021.csv"},
            "mark": {"type": "line", "color": "darkblue", "strokeWidth":4},
            "encoding": {
                "y": {"field": "ma"},
                "tooltip": [
                    {
                        "field": "ma",
                        "type": "quantitative",
                        "title": "7-day average"
                    },
                    {"timeUnit":"yearmonthdate", "field":"date", "title":"Date"}
                ]
            }
        }
    ]
  },
  {
    "width": 900,
    "height": 250,
    "title": "Total Percentage of Population Vaccinated",
    "encoding": {
      "x": {
        "timeUnit": "yearmonthdate",
        "field": "date", 
        "scale": {"domain": {"param": "brush"}},
        "axis": {"title": ""}
      },
      "y": {
        "type": "quantitative", 
        "axis": {"title": ""}
      }
    },
      "layer": [
        
        {   
            "data": {"url": "https://raw.githubusercontent.com/xzmonash/data/master/2021/vaccinations.csv"},
            "mark": {"type": "area", "color": "green", "opacity": 0.7},
            "transform": [
                {"calculate": "datum.cumul_partial/32365999*100", "as": "At Least One Dose"}
            ],
            "encoding": {
                "y": {"field": "At Least One Dose"},
                "tooltip":[
                  {
                    "field": "At Least One Dose",
                    "type": "quantitative",
                    "title": "At Least One Dose"
                  },
                  {"timeUnit":"yearmonthdate", "field":"date", "title":"Date"}
                ]
            }
        },
        {   "data": {"url": "https://raw.githubusercontent.com/xzmonash/data/master/2021/vaccinations.csv"},
            "mark": {"type": "area", "color": "darkgreen","opacity": 0.7},
            "transform": [
                {"calculate": "datum.cumul_full/32365999*100", "as": "Fully Vaccinated"}
            ],
            "encoding": {
                "y": {"field": "Fully Vaccinated"},
                "tooltip":[
                  {
                    "field": "Fully Vaccinated",
                    "type": "quantitative",
                    "title": "Fully Vaccinated"
                  },
                  {"timeUnit":"yearmonthdate", "field":"date", "title":"Date"}
                ]
            }
        }
    ]
    
  },

  {
    "width": 900,
    "height": 250,
    "title": "Daily Covid-19 Deaths",
    "encoding": {
        "x": {
            "timeUnit": "yearmonthdate",
            "field": "date",
            "scale": {"domain": {"param": "brush"}},
           "axis": {"title": ""}
        },
        "y": {"type": "quantitative", "axis": {"title": ""}},
        "tooltip": {}
    },
    "layer":[
        
        {   
            "data": {"url": "https://raw.githubusercontent.com/xzmonash/data/master/2021/deaths_malaysia.csv"},
            "mark": {"type": "area", "color": "red", "opacity": 0.7},
            "encoding": {
                "y": {"field": "deaths_new"},
                "tooltip":[
                  {
                    "field": "deaths_new",
                    "type": "quantitative",
                    "title": "Deaths"
                  },
                  {"timeUnit":"yearmonthdate", "field":"date", "title":"Date"}
                ]
            }
        },
        {   
            "data": {"url": "https://raw.githubusercontent.com/xzmonash/data/master/2021/7ma_deaths_malaysia.csv"},
            "mark": {"type": "line", "color": "red", "strokeWidth": 4},
            "encoding": {
                "y": {"field": "ma"},
                "tooltip":[
                  {
                    "field": "ma",
                    "type": "quantitative",
                    "title": "7-day average"
                  },
                  {"timeUnit":"yearmonthdate", "field":"date", "title":"Date"}
                ]
            }
        }
    ]
  }
  ]
}